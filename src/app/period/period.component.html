<a routerLink="/teams">All teams</a>

<h2><a routerLink="/team/{{team.id}}">{{team.displayName}}</a> : {{period.displayName}}</h2>

<div *ngFor="let bucket of period.buckets">
<h3>{{bucket.displayName}} <span [class.error]="totalAllocationPercentage() > 100">(<input type="number" [(ngModel)]="bucket.allocationPercentage"/>%)</span></h3>
<p><b [class.error]="bucketCommitted(bucket) > bucketAllocation(bucket)">
    {{bucketCommitted(bucket)}} of {{bucketAllocation(bucket) | number:'1.1-1'}} {{period.unit}} committed
</b></p>
<ul>
    <div *ngFor="let objective of bucket.objectives">
        <li>{{objective.name}} (<input type="number" [(ngModel)]="objective.resourceEstimate"/> {{period.unit}})</li>
        <ul *ngIf="objective.assignments">
            <li *ngFor="let assignment of objective.assignments">
                {{assignment.personId}}: <input type="number" [(ngModel)]="assignment.commitment"/> <span [class.error]="objectiveCommitted(objective) > objective.resourceEstimate">{{period.unit}}</span>
            </li>
        </ul>
    </div>
</ul>
</div>

<h3>People</h3>
<table>
    <tr><th></th><th>Available</th><th>Committed</th><th>Uncommitted</th></tr>
    <tr *ngFor="let person of period.people">
        <td><input [(ngModel)]="person.displayName"/> (<input [(ngModel)]="person.id"/>)</td>
        <td><input type="number" [(ngModel)]="person.availability"/></td>
        <td>{{personCommitted(person)}}</td>
        <td>{{personUncommitted(person)}}</td>
    </tr>
    <tr>
        <td><button (click)="addPerson()">Add</button></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td><b>Total</b></td>
        <td><b>{{totalAvailable()}}</b></td>
        <td><b>{{totalCommitted()}}</b></td>
        <td><b>{{totalUncommitted()}}</b></td>
    </tr>
</table>
<p>Default availability: <input type="number" [(ngModel)]="defaultPersonAvailability"/> {{period.unit}}</p>
